<?xml version="1.0" encoding="UTF-8"?><unload unload_date="2017-12-15 16:03:02"><sys_remote_update_set><application display_value="Global">global</application><application_name>Global</application_name><application_scope>global</application_scope><application_version/><collisions/><commit_date/><deleted/><description/><inserted/><name>TASK0071118 Tech Training-ServiceNow (CEID View) - add device list</name><origin_sys_id/><release_date/><remote_sys_id>20a566fe13290b40cb92b7a66144b0a8</remote_sys_id><state>loaded</state><summary/><sys_class_name>sys_remote_update_set</sys_class_name><sys_created_by>rwKeller</sys_created_by><sys_created_on>2017-12-15 16:03:02</sys_created_on><sys_id>a39284bd138b0380cb92b7a66144b0e3</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>rwKeller</sys_updated_by><sys_updated_on>2017-12-15 16:03:02</sys_updated_on><update_set/><update_source/><updated/></sys_remote_update_set><sys_update_xml><action>INSERT_OR_UPDATE</action><application display_value="Training Request">672bb5b1f8b80600e577b083ee9c1908</application><category>customer</category><comments/><name>sys_ui_related_u_training_request_approval</name><payload><![CDATA[<record_update><sys_ui_related sys_domain="global" table="u_training_request" version="2" view="approval"><sys_ui_related_list_entry action="INSERT_OR_UPDATE"><filter/><list_id display_value="Training Request - Approval" name="u_training_request" related_list="NULL" sys_domain="global" view="0cebef090a0006d40188d968934d3e9a">1b13feba13690b40cb92b7a66144b089</list_id><order_by/><position>0</position><related_list>task_ci.task</related_list><sys_class_name>sys_ui_related_list_entry</sys_class_name><sys_created_by>tlWeyer</sys_created_by><sys_created_on>2017-10-05 17:53:53</sys_created_on><sys_id>df13feba13690b40cb92b7a66144b089</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>tlWeyer</sys_updated_by><sys_updated_on>2017-10-05 17:53:53</sys_updated_on></sys_ui_related_list_entry><sys_ui_related_list action="INSERT_OR_UPDATE"><calculated_name>Training Request - Approval</calculated_name><filter/><name>u_training_request</name><order_by/><position/><related_list/><sys_class_name>sys_ui_related_list</sys_class_name><sys_created_by>tlWeyer</sys_created_by><sys_created_on>2017-10-05 17:53:53</sys_created_on><sys_customer_update>true</sys_customer_update><sys_domain>global</sys_domain><sys_id>1b13feba13690b40cb92b7a66144b089</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Training Request - Approval</sys_name><sys_package display_value="Training Request" source="672bb5b1f8b80600e577b083ee9c1908">672bb5b1f8b80600e577b083ee9c1908</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Training Request">672bb5b1f8b80600e577b083ee9c1908</sys_scope><sys_update_name>sys_ui_related_u_training_request_approval</sys_update_name><sys_updated_by>tlWeyer</sys_updated_by><sys_updated_on>2017-10-05 17:53:53</sys_updated_on><sys_user/><view display_value="Approval" name="approval">0cebef090a0006d40188d968934d3e9a</view><view_name/></sys_ui_related_list></sys_ui_related></record_update>]]></payload><remote_update_set display_value="TASK0071118 Tech Training-ServiceNow (CEID View) - add device list">a39284bd138b0380cb92b7a66144b0e3</remote_update_set><replace_on_upgrade>false</replace_on_upgrade><sys_created_by>rwKeller</sys_created_by><sys_created_on>2017-12-15 16:03:02</sys_created_on><sys_id>6b9284bd138b0380cb92b7a66144b0e3</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>rwKeller</sys_updated_by><sys_updated_on>2017-12-15 16:03:02</sys_updated_on><table>u_training_request</table><target_name>Training Request</target_name><type>Related Lists</type><update_domain>global</update_domain><update_set/><view>approval</view></sys_update_xml><sys_update_xml><action>INSERT_OR_UPDATE</action><application display_value="Training Request">672bb5b1f8b80600e577b083ee9c1908</application><category>customer</category><comments/><name>sys_ui_macro_eb38825cdb1e5200561fd9fdbf9619a1</name><payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Detail for Training Requests&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;approval_summarizer_u_training_request&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;amKatulak&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2016-03-17 14:35:23&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;eb38825cdb1e5200561fd9fdbf9619a1&lt;/sys_id&gt;&lt;sys_mod_count&gt;16&lt;/sys_mod_count&gt;&lt;sys_name&gt;approval_summarizer_u_training_request&lt;/sys_name&gt;&lt;sys_package display_value="Training Request" source="672bb5b1f8b80600e577b083ee9c1908"&gt;672bb5b1f8b80600e577b083ee9c1908&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Training Request"&gt;672bb5b1f8b80600e577b083ee9c1908&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_eb38825cdb1e5200561fd9fdbf9619a1&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;tlWeyer&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2017-10-05 20:39:46&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="false" xmlns:g="glide" xmlns:g2="null" xmlns:j="jelly:core" xmlns:j2="null"&gt;
  &lt;g:evaluate var="jvar_has_source" &gt;
    var flag = !${ref}.sysapproval.nil() || !${ref}.source_table.nil();
    flag;
  &lt;/g:evaluate&gt;
  &lt;j:if test="${jvar_has_source}"&gt;
    &lt;g:evaluate var="jvar_ni" expression="		
    	var gr = null;
        	if ( !${ref}.source_table.nil()) {
        	    gr = new GlideRecord(${ref}.source_table);
                    gr.get( ${ref}.document_id);
                } else {
                    gr = new GlideRecord('task');
                    gr.get(${ref}.sysapproval);
                }
        " /&gt;
    &lt;g:evaluate&gt;
        g_approval_form_request = true; // this global is checked in ACLs
    &lt;/g:evaluate&gt;
    &lt;g:evaluate var="jvar_my_form"&gt;
        var gc =  new GlideController();
        var p =  new GlidePopup(gc, "${gr.sys_class_name}");
        p.putParameter("sys_id", "${gr.sys_id}");
        p.putParameter("sysparm_view", "approval");
        //PRB579164: Skip g_form creation in activities.xml if activities displayed in formatter
        p.putParameter("sysparm_skip_gform", "true"); 
        var rp = p.getRenderProperties();
        rp.setSmallCaption(true);
        var s = p.getPopup();
        s;
    &lt;/g:evaluate&gt;
	  
	
	&lt;g:evaluate&gt;
		var ceids = new GlideRecord('task_ci');
		ceids.addQuery('task','${current.document_id}');
		ceids.query();
	&lt;/g:evaluate&gt;
	  
	 &lt;table&gt;
	 &lt;tr&gt;
	 &lt;th&gt;
	 Equipment ID
	 &lt;/th&gt;
	 &lt;/tr&gt;  
	  
    &lt;j:while ceid="${ceids.next()}"&gt;
		&lt;tr&gt;
		 &lt;td&gt;
		 ${ceid.name}
		 &lt;/td&gt;  
		&lt;/tr&gt;	  
    &lt;/j:while&gt;
	  &lt;/table&gt;
		 
	&lt;g:evaluate var="jvar_pdf_attach" object="true"&gt;
		var pdf_attach = new GlideRecord('sys_attachment');
		pdf_attach.addQuery('table_name','u_training_request');
		pdf_attach.addQuery('content_type','application/pdf');
		pdf_attach.addQuery('table_sys_id','${current.document_id}');
		pdf_attach.query();
		//while (pdf_attach.next()) {
			//var attach = 
			pdf_attach;
		//}
		//attach;
	&lt;/g:evaluate&gt;
        &lt;j:if test="${jvar_pdf_attach.next()}"&gt;
			
					&lt;embed height="${gs.getProperty('glide.kb.pdf.height')}" src="/sys_attachment.do?sysparm_referring_url=tear_off&amp;amp;view=true${AMP}sys_id=${jvar_pdf_attach.getValue('sys_id')}" type="application/pdf" width="${gs.getProperty('glide.kb.pdf.width')}"/&gt;
					&lt;br/&gt;
        &lt;/j:if&gt;
    &lt;tr id="approval_summary_row"&gt;
        &lt;td width="100%" colspan="2"&gt;
            &lt;j2:if test="${gs.getProperty('glide.security.use_csrf_token')}" &gt;
		&lt;input type="HIDDEN" name="sysparm_ck" value="$[gs.getSessionToken()]"/&gt;
	    &lt;/j2:if&gt;
            &lt;div id="approval_summary" style="padding-top:8px;display:none;"&gt;
  	        &lt;div class="caption" style="padding:4px;"&gt;${gs.getMessage('Summary of Training Request being approved ')}&lt;/div&gt;
  	        &lt;div style="padding-left:2px;"&gt;&lt;g:no_escape&gt;${jvar_my_form}&lt;/g:no_escape&gt;&lt;/div&gt;
			&lt;a onclick="MoreInfo()" href="#"&gt; ${gs.getMessage('Click here to view the entire record')}&lt;/a&gt;&lt;BR/&gt;
            &lt;/div&gt;
			
			
  	&lt;/td&gt;
    &lt;/tr&gt;

	  
    &lt;g:evaluate&gt;
        delete g_approval_form_request; // removes the global
    &lt;/g:evaluate&gt;
    &lt;script&gt;
        addRenderEvent(moveSummaryForm);
        function moveSummaryForm() {
            var e = $("approval_summary");
            var form = $("sysapproval_approver.do");
            var formParent = form.parentNode;
            formParent.appendChild(e);
            e.show();
        }
        function MoreInfo(){
           //Create and open the dialog form
           //Provide dialog title and table name
           var dialog = new GlideDialogForm('Affected CEIDs', 'u_training_request');
           dialog.setSysID('${gr.sys_id}'); //Pass in sys_id to edit existing record, -1 to create new record
           dialog.addParm('sysparm_view', 'Default view'); //Specify a form view
           dialog.addParm('sysparm_form_only', 'true'); //Add or remove related lists
           dialog.setLoadCallback(function(iframeDoc) {
               // To get the iframe: document.defaultView in non-IE, document.parentWindow in IE
                var dialogFrame = 'defaultView' in iframeDoc ? iframeDoc.defaultView : iframeDoc.parentWindow;
                //dialogFrame.g_form.setValue('close_notes', 'Hello world!');
                dialogFrame = null;
             });
             dialog.render(); //Open the dialog
         }		
    &lt;/script&gt;
  &lt;/j:if&gt;	
&lt;/j:jelly&gt;]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload><remote_update_set display_value="TASK0071118 Tech Training-ServiceNow (CEID View) - add device list">a39284bd138b0380cb92b7a66144b0e3</remote_update_set><replace_on_upgrade>false</replace_on_upgrade><sys_created_by>rwKeller</sys_created_by><sys_created_on>2017-12-15 16:03:02</sys_created_on><sys_id>a79284bd138b0380cb92b7a66144b0e3</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>rwKeller</sys_updated_by><sys_updated_on>2017-12-15 16:03:02</sys_updated_on><table/><target_name>approval_summarizer_u_training_request</target_name><type>Macro</type><update_domain>global</update_domain><update_set/><view/></sys_update_xml></unload>